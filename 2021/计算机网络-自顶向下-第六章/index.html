<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="一些我的计算机笔记，JAVA/Python/Linux/后端/计算机基础"><title>计算机网络(自顶向下)第六章 | 懒人瑜恩</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=1.0.0"><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/normalize.css/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/purecss/build/pure-min.min.css"><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/purecss/build/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.jsdelivr.net/npm/jquery/dist/jquery.min.js"></script><link rel="icon" mask="" sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = 'https://hm.baidu.com/hm.js?' + '2059a4484fb666484cf5e9fba7e20ce6';
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
  })();
</script><script type="text/javascript" src="//cdn.jsdelivr.net/npm/clipboard/dist/clipboard.min.js"></script><script type="text/javascript" src="//cdn.jsdelivr.net/gh/codeseven/toastr/build/toastr.min.js"></script><link rel="stylesheet" href="//cdn.jsdelivr.net/gh/codeseven/toastr/build/toastr.min.css"><meta name="generator" content="Hexo 5.3.0"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">计算机网络(自顶向下)第六章</h1><a id="logo" href="/.">懒人瑜恩</a><p class="description">sometimes code, sometimes English</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/tags/"><i class="fa fa-tag"> 标签</i></a><a href="/history/"><i class="fa fa-book"> 历史</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">计算机网络(自顶向下)第六章</h1><div class="post-meta">2021-10-16<span> | </span><span class="category"><a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/">计算机网络</a></span></div><div class="clear"><div class="toc-article" id="toc"><div class="toc-title">文章目录</div><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%93%BE%E8%B7%AF%E5%B1%82%E5%92%8C%E5%B1%80%E5%9F%9F%E7%BD%91"><span class="toc-number">1.</span> <span class="toc-text">链路层和局域网</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%BC%E8%AE%BA"><span class="toc-number">1.1.</span> <span class="toc-text">导论</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B7%AE%E9%94%99%E6%A3%80%E6%B5%8B%E5%92%8C%E7%BA%A0%E6%AD%A3"><span class="toc-number">1.2.</span> <span class="toc-text">差错检测和纠正</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%9A%E7%82%B9%E8%AE%BF%E9%97%AE%E5%8D%8F%E8%AE%AE"><span class="toc-number">1.3.</span> <span class="toc-text">多点访问协议</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9A%8F%E6%9C%BA%E5%AD%98%E5%8F%96%E5%8D%8F%E8%AE%AE"><span class="toc-number">1.3.1.</span> <span class="toc-text">随机存取协议</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%97%B6%E9%9A%99ALOHA"><span class="toc-number">1.3.1.1.</span> <span class="toc-text">时隙ALOHA</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%BA%AFALOHA%EF%BC%88%E9%9D%9E%E6%97%B6%E9%9A%99%EF%BC%89"><span class="toc-number">1.3.1.2.</span> <span class="toc-text">纯ALOHA（非时隙）</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#CSMA%EF%BC%88%E8%BD%BD%E6%B3%A2%E4%BE%A6%E5%90%AC%E5%A4%9A%E8%B7%AF%E8%AE%BF%E9%97%AE%EF%BC%89"><span class="toc-number">1.3.1.3.</span> <span class="toc-text">CSMA（载波侦听多路访问）</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#CSMA-CD%EF%BC%88%E5%86%B2%E7%AA%81%E6%A3%80%E6%B5%8B%EF%BC%89"><span class="toc-number">1.3.1.4.</span> <span class="toc-text">CSMA&#x2F;CD（冲突检测）</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%97%A0%E7%BA%BF%E5%B1%80%E5%9F%9F%E7%BD%91%EF%BC%9ACSMA-CA"><span class="toc-number">1.3.1.5.</span> <span class="toc-text">无线局域网：CSMA&#x2F;CA</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%BA%BF%E7%BC%86%E6%8E%A5%E5%85%A5%E7%BD%91%E7%BB%9C"><span class="toc-number">1.3.1.6.</span> <span class="toc-text">线缆接入网络</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BD%AE%E6%B5%81%EF%BC%88Taking-Turns%EF%BC%89MAC%E5%8D%8F%E8%AE%AE"><span class="toc-number">1.3.2.</span> <span class="toc-text">轮流（Taking Turns）MAC协议</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#LANs"><span class="toc-number">1.4.</span> <span class="toc-text">LANs</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#addressing%EF%BC%8CARP"><span class="toc-number">1.4.1.</span> <span class="toc-text">addressing，ARP</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Ethernet"><span class="toc-number">1.4.2.</span> <span class="toc-text">Ethernet</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#802-11-WLAN"><span class="toc-number">1.4.3.</span> <span class="toc-text">802.11 WLAN</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#switches"><span class="toc-number">1.4.4.</span> <span class="toc-text">switches</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#VLANs"><span class="toc-number">1.4.5.</span> <span class="toc-text">VLANs</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%93%BE%E8%B7%AF%E8%99%9A%E6%8B%9F%E5%8C%96%EF%BC%9AMPLs"><span class="toc-number">1.5.</span> <span class="toc-text">链路虚拟化：MPLs</span></a></li></ol></li></ol></div></div><div class="post-content"><a id="more"></a>

<h2 id="链路层和局域网"><a href="#链路层和局域网" class="headerlink" title="链路层和局域网"></a>链路层和局域网</h2><blockquote>
<p>网络层解决一个网络到达另一个网络的路由问题</p>
<p>链路层：网络内部如何由一个节点（主机或路由器）到达另一个相邻节。（点到点连接，多点连接）</p>
<p>wan：网络形式采用点到点链路</p>
<p>LAN：一般采用多点连接方式</p>
</blockquote>
<h3 id="导论"><a href="#导论" class="headerlink" title="导论"></a>导论</h3><p>术语</p>
<ul>
<li>主机和路由器：nodes（节点）</li>
<li>沿着通信路径，连接相邻节点通信信道的是<strong>链路</strong>：links（无线，有线，局域网，共享性链路）</li>
<li>第二层协议数据单元帧frame，封装数据报</li>
</ul>
<blockquote>
<p><strong>数据链路层负责从一个节点通过链路将数据报发送到相邻的物理节点</strong></p>
</blockquote>
<p><strong>链路层：上下文</strong></p>
<p>数据报在不同链路上以不同的链路协议传送：</p>
<ol>
<li>第一跳：以太网</li>
<li>中间链路：帧中继链路</li>
<li>最后一跳：802.11</li>
</ol>
<p>传输类比</p>
<ul>
<li>从A到B<ul>
<li>有不同交通工具</li>
</ul>
</li>
<li>旅行者=数据报datagram</li>
<li>交通段=通信链路communication link</li>
<li>交通模式=链路层协议：数据链路层和局域网protocol</li>
<li>票务代理=路由算法routing algorithm</li>
</ul>
<p><strong>链路层服务</strong></p>
<p>流量控制，错误检测，差错纠正，半双工和全双工</p>
<p>成帧，链路接入：</p>
<ul>
<li><p>将数据报封装在帧中，加上帧头、帧尾部</p>
</li>
<li><p>如果采用的是共享性介质，信道接入获得信道访问权</p>
</li>
<li><p>在帧头部使用“MAC”（物理）地址来标示源和目的 ，不同于IP地址</p>
</li>
</ul>
<p><strong>相邻节点内完成可靠数据传输</strong></p>
<p>低差错的链路上很少使用（光纤，一些双绞线）</p>
<p>高差错链路上需要进行可靠数据传送（无线链路）</p>
<p><strong>链路层的实现位置</strong></p>
<ul>
<li><p>主机</p>
</li>
<li><p>”适配器“（aka network interface and NIC)或者在一个芯片组上</p>
<ul>
<li>以太网卡，802.11网卡，以太网芯片组</li>
<li>实现链路层和响应的物理层功能</li>
</ul>
<p><img src="https://gitee.com/yvenxx/git-book-image/raw/master/images/image-20211016155954402.png" alt="image-20211016155954402"></p>
</li>
<li><p>接到主机的系统总线上</p>
</li>
<li><p>硬件，软件，固件的综合体</p>
</li>
</ul>
<h3 id="差错检测和纠正"><a href="#差错检测和纠正" class="headerlink" title="差错检测和纠正"></a>差错检测和纠正</h3><p>EDC=差错检测和纠正位（冗余位），D =数据由差错检测保护，可以包含头部字段</p>
<blockquote>
<p>错误检测不是100%可靠，会漏检一些错误，但是错误更少。更长的EDC字段可以得到更好的检测和纠正效果</p>
</blockquote>
<p><img src="https://gitee.com/yvenxx/git-book-image/raw/master/images/image-20211017092217140.png" alt="image-20211017092217140"></p>
<p><strong>奇偶校验</strong></p>
<p><strong>单bit奇偶校验（检测耽搁bit级错误），2维奇偶校验（检测和纠正单个bit错误）</strong></p>
<p><strong>Internet校验和</strong></p>
<p>目标：检测在传输报文段时的错误（如位翻转）且仅用在传输层</p>
<p><strong>发送方</strong></p>
<ul>
<li>将报文段看成16-bit整数</li>
<li>报文段和校验和：和（1‘的补码和）</li>
<li>发送方将checksum的值放在’UDP校验和‘字段</li>
</ul>
<p><strong>接收方</strong></p>
<ul>
<li><strong>计算</strong>接收到的报文段的校验和</li>
<li>检查是否与携带校验和字段值一致<ul>
<li>不一致：有错误</li>
<li>一致：没有检出错误，但可能有错</li>
</ul>
</li>
</ul>
<p><strong>检验和：CRC</strong>（循环冗余校验）</p>
<ul>
<li><p>强大的差错检测码</p>
</li>
<li><p>将数据比特 D, 看成是二进制的数据</p>
</li>
<li><p>生成多项式G：双方协商r+1位模式（r次方） ，生成和检查所使用的位模式</p>
</li>
</ul>
<p>目标：选择r位 CRC附加位R，使得</p>
<ul>
<li>&lt;D,R&gt;正好被G整除（modulo 2）</li>
<li>接收方知道G，将&lt;D,R&gt;除以G，如果非0余数：检查出错误</li>
<li>能检出所有少于r+1位的突发错误</li>
</ul>
<p><img src="https://gitee.com/yvenxx/git-book-image/raw/master/images/image-20211017095037279.png" alt="image-20211017095037279"></p>
<p><img src="https://gitee.com/yvenxx/git-book-image/raw/master/images/image-20211017095103093.png" alt="image-20211017095103093"></p>
<h3 id="多点访问协议"><a href="#多点访问协议" class="headerlink" title="多点访问协议"></a>多点访问协议</h3><p><strong>多路访问链路和协议</strong></p>
<ul>
<li>点对点（拨号访问的PPP，以太网交换机和主机间的点对点链路）</li>
<li>广播（共享链路或媒体）传统以太网，HFC上行链路，802.11无线局域网</li>
</ul>
<p><strong>协议</strong></p>
<p>单个共享的广播型链路，2个或更多的站点同时发送会<strong>冲突（collision）</strong></p>
<p><strong>多路访问协议（介质访问控制协议：MAC）</strong></p>
<p>MAC（媒体访问控制）协议：分类</p>
<ul>
<li>信道划分<ul>
<li>把信号分成小片（时间TDMA，频率FDMA，编码CDMA）</li>
<li>分配片个每个节点专用</li>
</ul>
</li>
<li>随机访问<ul>
<li>信号不划分，允许冲突</li>
<li>冲突后恢复</li>
</ul>
</li>
<li>依次轮流<ul>
<li>节点依次轮流</li>
<li>但是有很多数据传输的节点可以获得较长的信道使用权</li>
</ul>
</li>
</ul>
<h4 id="随机存取协议"><a href="#随机存取协议" class="headerlink" title="随机存取协议"></a><strong>随机存取协议</strong></h4><p>当节点有帧要发送时，以<strong>信道带宽的全部R bps</strong>发送，没有节点间的预先协调。</p>
<p>两个或更多节点同时传输，会发生冲突（collision）</p>
<p>随机存取协议规定了，如何检测冲突，如何从冲突中恢复。还有随机MAC协议（时隙ALOHA，ALOHA，CSMA，CSMA/CD，CSMA/CA）</p>
<h5 id="时隙ALOHA"><a href="#时隙ALOHA" class="headerlink" title="时隙ALOHA"></a>时隙ALOHA</h5><p>假设：所有帧是等长的，时间被划分成相等的<strong>时隙</strong>，每个时隙可发送一帧。节点只在时隙开始时发送帧，节点在时钟上是同步的，如果两个或多个节点在一个时隙传输，所有站点都能检测到冲突。</p>
<p>运行</p>
<ul>
<li>当节点获取心的帧，在下一个时隙传输</li>
<li>传输时没有检测到冲突，成功，节点能够在下一时隙发送帧</li>
<li>检测到冲突，失败，节点在每一个随后的时隙以概率p重传帧直到成功</li>
</ul>
<blockquote>
<p>优点：节点可以以信道带宽全速连续传输。高度分布，仅需要节点之间在时隙上同步。</p>
<p>缺点：存在冲突，浪费时隙。即使有帧要发送仍然有可能存在空闲的时隙。节点检测冲突的时间&lt;帧传输的时间。且必须传完，需要时钟同步</p>
</blockquote>
<p>最好的情况：效率利用率37%</p>
<h5 id="纯ALOHA（非时隙）"><a href="#纯ALOHA（非时隙）" class="headerlink" title="纯ALOHA（非时隙）"></a>纯ALOHA（非时隙）</h5><p>无时隙ALOHA：简单，无须节点间在时间上同步。当有帧需要传输：马上传输。冲突的概率增加。</p>
<p>效率相比时隙ALOHA更差</p>
<h5 id="CSMA（载波侦听多路访问）"><a href="#CSMA（载波侦听多路访问）" class="headerlink" title="CSMA（载波侦听多路访问）"></a><strong>CSMA（载波侦听多路访问）</strong></h5><p>在传输前先侦听信道，如果信道空闲，传送整个帧。信道忙，推迟传送</p>
<p>冲突：仍然可能发生，由传播延迟造成，两个节点可能侦听不到正在进行的传输。整个冲突帧的传输时间都被浪费，是无效传输。传播延迟决定冲突的概率。</p>
<h5 id="CSMA-CD（冲突检测）"><a href="#CSMA-CD（冲突检测）" class="headerlink" title="CSMA/CD（冲突检测）"></a>CSMA/CD（冲突检测）</h5><p>载波侦听CSMA：和在CSMA中一样发送前侦听信道，没有传完一个帧就可以在短时间内检测到冲突，冲突发生时则传输终止，减少对信道的浪费</p>
<p><strong>冲突检测CD技术</strong>，有线局域网中容易实现：检测信号强度，比较传输与接收到的信号是否相同，通过周期的过零点检测</p>
<p><img src="https://gitee.com/yvenxx/git-book-image/raw/master/images/image-20211017103404876.png" alt="image-20211017103404876"></p>
<p><strong>CSMA/CD算法</strong></p>
<ol>
<li><p>适配器获取数据报，创建帧</p>
</li>
<li><p>发送前：侦听信道CS</p>
<p>1)闲：开始传送帧</p>
<p>2)忙：一直等到闲再发送</p>
</li>
<li><p>发送过程中，冲突检测CD</p>
<p>1)没有冲突:成功</p>
<p>2)检测到冲突:放弃,之后尝试重发</p>
</li>
<li><p>发送方适配器检测到冲突，除放弃外，还发送一个Jam信号，所有听到冲突的适配器也是如此</p>
<p><strong>强化冲突：让所有站点都知道冲突</strong></p>
</li>
<li><p>如果放弃，适配器进入指数退避状态</p>
<p>第m次失败后，适配器随机选择一个{ 0 到  2^(m-1) }为k，等待k*512位时间，然后转到步骤2（指数退避）</p>
</li>
</ol>
<p><strong>指数退避</strong></p>
<p>首次碰撞：在{0，1}选择K；延迟K*512位时，第2次碰撞：在{0，1，2，3}选择K，第10次碰撞：在{0，1，2，3，……，1023}选择K</p>
<p><strong>效率：比ALOHA更好的性能，简单，廉价，分布式</strong></p>
<h5 id="无线局域网：CSMA-CA"><a href="#无线局域网：CSMA-CA" class="headerlink" title="无线局域网：CSMA/CA"></a>无线局域网：CSMA/CA</h5><p><strong>发送方</strong></p>
<p>1 如果站点侦测到信道空闲持续**DIFS长，则传输整个帧 **(no CD)</p>
<p>2 如果侦测到信道忙碌，那么 选择一个随机回退值，并在信道空闲时递减该值；如果信道忙碌，回退值不会变化到数到0时（只生在信道闲时）发送整个帧如果没有收到ACK, 增加回退值，重复2</p>
<p><strong>802.11接收方</strong></p>
<p>如果帧正确，则在SIFS后发送ACK</p>
<p>IEEE 802.11 MAC协议：CSMA/CA</p>
<p>在count down时，侦听到了信道空闲为什么不发送，而要等到0时在发送</p>
<ul>
<li><p>2个站点有数据帧需要发送，第三个节点正在发送</p>
</li>
<li><p>LAN CD：让2者听完第三个节点发完，立即发送</p>
</li>
<li><p>冲突：放弃当前的发送，避免了信道的浪费于无用冲突帧的发送。代价不昂贵</p>
</li>
</ul>
<p>无法完全避免冲突，例如AB都要等C发送完，但是AB的值很接近。可能会冲突等等</p>
<p><strong>WLAN：CA</strong></p>
<p>无法CD，一旦发送必须发完，冲突就会导致信道浪费。</p>
<p><strong>冲突避免</strong></p>
<p>允许发送方“预约”信道，而不是随机访问该信道: 避免长数据帧的冲突（可选项）</p>
<ul>
<li><p>发送方首先使用CSMA向BS发送一个小的RTS分组，RTS可能会冲突（但是由于比较短，浪费信道较少）</p>
</li>
<li><p>BS广播 clear-to-send CTS，作为RTS的响应</p>
</li>
<li><p>CTS能够被所有涉及到的节点听到，发送方发送数据帧，其它节点抑制发送</p>
</li>
</ul>
<p><img src="https://gitee.com/yvenxx/git-book-image/raw/master/images/image-20211017110306509.png" alt="image-20211017110306509"></p>
<h5 id="线缆接入网络"><a href="#线缆接入网络" class="headerlink" title="线缆接入网络"></a>线缆接入网络</h5><p><img src="https://gitee.com/yvenxx/git-book-image/raw/master/images/image-20211017111405264.png" alt="image-20211017111405264"></p>
<p><strong><em>多个</em></strong>40Mbps 下行(广播)信道,FDM </p>
<p>​    下行：通过FDM分成若干信道，互联网、数字电视等 </p>
<p>​    互联网信道：只有1个CMTS在其上传输</p>
<p><strong><em>多个</em></strong>30 Mbps上行的信道,FDM </p>
<p>​    <strong>多路访问</strong>：所有用户使用；接着TDM分成微时隙</p>
<p>​    部分时隙：分配；部分时隙：竞争；</p>
<h4 id="轮流（Taking-Turns）MAC协议"><a href="#轮流（Taking-Turns）MAC协议" class="headerlink" title="轮流（Taking Turns）MAC协议"></a>轮流（Taking Turns）MAC协议</h4><p>信道划分MAC协议：</p>
<ul>
<li>共享信道在高负载时是有效和公平的</li>
<li>在低负载时效率地下，只能等到自己的时隙开始发送或者利用1/N的信道频率发送。当只有一个节点有帧传时，也只能够得到1/N个带宽分配</li>
</ul>
<p>随机访问MAC协议</p>
<ul>
<li>在低负载时效率高，单个节点完全可以利用信道全部带宽</li>
<li>高负载时，冲突开销较大，效率极低，时间很多浪费在冲突中</li>
</ul>
<p>轮流协议：有两者优点</p>
<p>轮流询问:</p>
<p>主节点邀请从节点依次传送，从节点一般比较 “dumb”</p>
<p>缺点: </p>
<ul>
<li><p>轮询开销：轮询本身消耗信道带宽 </p>
</li>
<li><p>等待时间：每个节点需等到主节点轮询后开始传输，即使只有一个节点，也需要等到轮询一周后才能够发送 </p>
</li>
<li><p>单点故障：主节点失效时造成整个系统无法工作</p>
</li>
</ul>
<p><strong>令牌传递</strong>: </p>
<p>控制令牌( token)循环从一个节点到下一个节点传递</p>
<p>令牌报文：特殊的帧</p>
<p>缺点: </p>
<ul>
<li><p>令牌开销：本身消耗带宽 </p>
</li>
<li><p>延迟：只有等到抓住令牌，才可传输 </p>
</li>
<li><p>单点故障 (token)： </p>
<ul>
<li>令牌丢失系统级故障，整个系统无法传输 </li>
<li>复杂机制重新生成令牌</li>
</ul>
</li>
</ul>
<p><img src="https://gitee.com/yvenxx/git-book-image/raw/master/images/image-20211017112508792.png" alt="image-20211017112508792"></p>
<h3 id="LANs"><a href="#LANs" class="headerlink" title="LANs"></a>LANs</h3><h4 id="addressing，ARP"><a href="#addressing，ARP" class="headerlink" title="addressing，ARP"></a>addressing，ARP</h4><p>MAC地址和ARP</p>
<p>32位 bit IP地址</p>
<ul>
<li>网络层地址</li>
<li>前n-1跳：用于使数据报到达目的IP子网</li>
<li>最后一条：到达子网中的目标节点</li>
</ul>
<p>LAN（MAC/物理/以太网）地址：</p>
<ul>
<li>用于使帧从一个网卡传递到与其物理连接的另一个网卡（在同一个物理网络中）</li>
<li>48bit MAC地址固化在适配器的ROM，有时也可以通过软件设定，理论上全球任何一个网卡MAC都不同</li>
</ul>
<p><strong>网络地址和物理地址分离</strong></p>
<p>IP地址是分层的，一个子网所有站点网络号一致，路由聚集，减少路由表。IP地址完成网络到网络的交付</p>
<p>mac地址是平面的：网卡在生产时给一个唯一标识，用于区分一个网络内部不同的网卡即可。可以完成一个物理网络内部的节点到节点的数据交付</p>
<blockquote>
<p>局域网上每一个适配器都有一个唯一的<strong>LAN</strong>地址</p>
</blockquote>
<p>MAC地址有IEEE管理和分配，制造商购入MAC地址空间（保证唯一性），MAC地址可以进行移动，不影响IP地址，IP地址有层次，不能移动</p>
<p><strong>Address Rseolution Protocol（ARP)</strong></p>
<p>在LAN上的每个IP节点都有一个ARP表（包括一些LAN节点IP/MAC地址的映射 《IP,MAC，TTL》）</p>
<p>同一个网络中</p>
<p>A要发送帧给B，B的MAC地址不在A的ARP表中，A广播包含B的ip地址的ARP查询包，B接收到ARP包，恢复A自己的MAC地址，A在ARP中缓存B的mac地址。</p>
<p>不同网络中，用iP先到那个路由表，然后该地方的路由器会找到要传送的MAC地址</p>
<h4 id="Ethernet"><a href="#Ethernet" class="headerlink" title="Ethernet"></a>Ethernet</h4><p>以太网：目前最主流的LAN技术：98的占有率，最早广泛应用的LAN技术，比令牌网和ATM网络简单，廉价</p>
<p><strong>物理拓扑</strong></p>
<p>总线</p>
<p>星形（目前最主流），使用hub或switch，现在一般是交换机在中心。</p>
<p><img src="https://gitee.com/yvenxx/git-book-image/raw/master/images/image-20211017123355782.png" alt="image-20211017123355782"></p>
<p><strong>以太帧结构</strong></p>
<p>发送方适配器在以太网帧中封装IP数据报或其他玩路过层协议数据单元</p>
<p><img src="https://gitee.com/yvenxx/git-book-image/raw/master/images/image-20211017123433548.png" alt="image-20211017123433548"></p>
<p><img src="https://gitee.com/yvenxx/git-book-image/raw/master/images/image-20211017123509472.png" alt="image-20211017123509472"></p>
<p>以太网：无连接，不可靠</p>
<p>无连接：帧传输前，发送方和接收方之间没有握手</p>
<p>不可靠：接收方适配器不发送ACKs或NAKs给发送方，递交给网络层的数据报流可能有gap</p>
<p>以太网的MAC协议，采用<strong>二进制退避的CSMA/CD介质访问控制形式</strong></p>
<p><strong>Hubs</strong></p>
<p>Hubs 本质上是物理层的中继器: </p>
<ul>
<li><p>从一个端口收，转发到所有其他端口</p>
</li>
<li><p>速率一致</p>
</li>
<li><p>没有帧的缓存</p>
</li>
<li><p>在hub端口上没有CSMA/CD机制:适配器检测冲突</p>
</li>
<li><p>提供网络管理功能</p>
</li>
</ul>
<p><img src="https://gitee.com/yvenxx/git-book-image/raw/master/images/image-20211017124014124.png" alt="image-20211017124014124"></p>
<p><strong>Manchester编码</strong></p>
<p><img src="https://gitee.com/yvenxx/git-book-image/raw/master/images/image-20211017124149266.png" alt="image-20211017124149266"></p>
<p>在10BaseT中使用，每一个bit的位时中间有一个信号跳变，允许在接收方和发送方节点之间进行时钟同步</p>
<p><strong>100baseT使用4b5b编码</strong></p>
<p><img src="https://gitee.com/yvenxx/git-book-image/raw/master/images/image-20211017124326145.png" alt="image-20211017124326145"></p>
<p>千兆以太网</p>
<ul>
<li>采用标准的以太帧格式</li>
<li>允许点对点链路和共享广播信道</li>
<li>物理编码：8b10b编码</li>
<li>在共享模式，继续使用CSMA/CD MAC技术，节点间需要较短距离以提高利用率</li>
<li>交换模式：全双工千兆可用于点对点链路<ul>
<li>站点使用专用信道，基本不会冲突，除非发往同一个节点</li>
</ul>
</li>
<li>10 Gbps</li>
</ul>
<h4 id="802-11-WLAN"><a href="#802-11-WLAN" class="headerlink" title="802.11 WLAN"></a>802.11 WLAN</h4><p>802.11b，802.11a，802.11g，802.11n等，所有802.11标准都是CSMA/CA进行多路访问，都有基站模式和自组织网络模式</p>
<p><strong>802.11LAN 体系结构</strong></p>
<p>无线主机与基站通信，**基站（base station） = 接入点（access point（AP)）</p>
<p>基础设施模式下的<strong>基本服务集Basic Service Set（BSS）</strong></p>
<ul>
<li>无线主机</li>
<li>接入点（AP）：基站</li>
<li>自组织模式下：只有无线主机</li>
</ul>
<p><img src="https://gitee.com/yvenxx/git-book-image/raw/master/images/image-20211017141158756.png" alt="image-20211017141158756"></p>
<p><strong>802.11：信道与关联</strong></p>
<p>802.11b：2.4GHz-2.485GHz频谱被分为11个相互不同的但是部分重叠的频段</p>
<ul>
<li>AP管理员为AP选择一个频率</li>
<li>可能的干扰：邻居AP可能选择同样一个信道</li>
</ul>
<p>主机：必须在通信之前和AP建立<strong>associate</strong></p>
<ul>
<li>扫描所有的信道，侦听包含AP SSID和MAC地址的信标帧<ul>
<li>主动扫描：主机发送真的，接收AP的响应</li>
<li>被动扫描</li>
</ul>
</li>
<li>选择希望关联的AP</li>
<li>可能需要执行鉴别（认证），基于MAC，用户名口令，通过AP的中继，使用RADIUS鉴别服务器进行身份鉴别</li>
<li>将会执行DHCP获得IP地址和AP所在的子网前缀</li>
</ul>
<p>主动扫描–被动扫描</p>
<p><img src="https://gitee.com/yvenxx/git-book-image/raw/master/images/image-20211017142228001.png" alt="image-20211017142228001"></p>
<p><strong>802.11地址</strong></p>
<p><img src="https://gitee.com/yvenxx/git-book-image/raw/master/images/image-20211017142343269.png" alt="image-20211017142343269"></p>
<p>duration：预约传输时间的持续期(RTS/CTS)</p>
<p>seq control：帧序号（for RDT)</p>
<p><strong>frame control中</strong></p>
<p><img src="https://gitee.com/yvenxx/git-book-image/raw/master/images/image-20211017142609921.png" alt="image-20211017142609921"></p>
<h4 id="switches"><a href="#switches" class="headerlink" title="switches"></a>switches</h4><p><strong>Hub:集线器</strong></p>
<p>网段（LAN segments）：可以允许一个站点发送的玩路过范围。通常拥有相同的前缀，比IP子网更详细的前缀。在一个碰撞域，同时只允许一个站点在发送，如果有两个节点同时发送，则会碰撞。</p>
<p>所有以Hub连到一起的站点，处在一个网段，一个碰撞域</p>
<p>通过hub可扩展节点之间的最大距离，但是不能将10BaseT和100BaseT的网络连接在一起</p>
<p><strong>Switches</strong>（交换机）</p>
<p>链路层设备：扮演主动角色（端口执行以太网协议）</p>
<ul>
<li>对帧进行存储和转发，对于过来的帧，检查帧头，根据目标MAC地址进行选择性转发。</li>
<li>当帧需要向某个网段进行转发，使用CSMA/CD进行接入控制。但通常一个交换机端口一个独立网段</li>
</ul>
<p><strong>多路同时传输</strong></p>
<p>因为是端口连接，所以只要A—B，C—D，这样不会互相影响。每条链路都是独立的碰撞域。</p>
<p>其中交换机都有一个转发表，知道每个表项。</p>
<p><strong>自学习</strong></p>
<p>当接收到帧时，交换机就会记录到发送站点所在的端口（网段），记录发送方MAC地址进入端口映射关系，在交换表中</p>
<p><strong>交换机和路由器</strong></p>
<p>都是存储转发设备，层次不同</p>
<ul>
<li>交换机：链路层设备（检查链路层头部）</li>
<li>路由器：网络层设备（检查网络层的头部）</li>
</ul>
<p>都有转发表</p>
<ul>
<li>交换机：维护交换表，按照MAC地址转发</li>
<li>路由器：维护路由表，执行路由算法</li>
</ul>
<h4 id="VLANs"><a href="#VLANs" class="headerlink" title="VLANs"></a>VLANs</h4><p>基于端口的VLAN：交换机端口成组（通过交换机管理软件），以至于<strong>单个的</strong>交换机可以分成若干虚拟LANs。（一个物理LAN基础的设置，虚拟成多个LANs）</p>
<p><img src="https://gitee.com/yvenxx/git-book-image/raw/master/images/image-20211017145353221.png" alt="image-20211017145353221"></p>
<p>流量隔离：从/到1-8端口的流量只会设计到1-8</p>
<p>动态成员：成员可以在VLANs之间动态分配</p>
<p>在VLANs间转发：通过路由器进行转发</p>
<h3 id="链路虚拟化：MPLs"><a href="#链路虚拟化：MPLs" class="headerlink" title="链路虚拟化：MPLs"></a>链路虚拟化：MPLs</h3><p>建立基于标签的转发表-信令协议：支持逐跳和显示路由：路由信息传播，路由计算（基于Qos，基于策略的），标签分发。</p>
<ul>
<li><p>从IP网络来看，将一组支持MPLS的网络虚拟成链路的技术</p>
</li>
<li><p>纯IP网络是按照IP地址对分组进行转发的，前缀匹配，转发的方法固定，无法控制IP分组的路径，无法支持流连工程，也无法对一个IP分组流进行资源分配，性能无法保证</p>
</li>
<li><p>MPLs网络按照标签label进行分组的转发，类似与VC，有基于标签的<strong>转发表</strong>，基于虚电路表，IP vs 线路交换</p>
</li>
</ul>
<p><strong>标签交换的过程</strong></p>
<ol>
<li>入口路由器：LER对进入的分组按照EFC的定义打上标签</li>
<li>在MPLS网络中（虚拟成了链路）对分组按照标签进行交换</li>
<li>到了出口路由器，在将标签摘除</li>
<li>支持MPLS的路由器组构成的网络，从IP网络的角度来看虚拟成了链路</li>
</ol>
<p><strong>优点</strong></p>
<p>路由弹性：基于Qos，基于策略的</p>
<p>充分利用已有的硬件ATM快速转发，支持流连工程，VPN…..</p>
</div><div class="post-copyright"><script type="text/javascript" src="/js/copyright.js" successtext="复制成功!"></script><link rel="stylesheet" type="text/css" href="/css/copyright.css"><p><span>本文标题：</span>计算机网络(自顶向下)第六章</p><p><span>文章作者：</span>懒人瑜恩</p><p><span>发布时间：</span>2021-10-16</p><p><span>最后更新：</span>2021-10-17</p><p><span>原始链接：</span><a href="/2021/计算机网络-自顶向下-第六章/">https://yvenxx.github.io/yvenxx/2021/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-%E8%87%AA%E9%A1%B6%E5%90%91%E4%B8%8B-%E7%AC%AC%E5%85%AD%E7%AB%A0/</a><span class="copy-path"><i class="fa fa-clipboard" data-clipboard-text="https://yvenxx.github.io/yvenxx/2021/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-%E8%87%AA%E9%A1%B6%E5%90%91%E4%B8%8B-%E7%AC%AC%E5%85%AD%E7%AB%A0/"></i></span></p><p><span>版权声明：</span>版权所有，转载请注明出处。</p></div><br><script type="text/javascript" src="/js/share.js?v=1.0.0" async></script><a class="article-share-link" data-url="https://yvenxx.github.io/yvenxx/2021/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-%E8%87%AA%E9%A1%B6%E5%90%91%E4%B8%8B-%E7%AC%AC%E5%85%AD%E7%AB%A0/" data-id="cl1p05tdc00253ku32u99a42o" data-qrcode="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASYAAAEmCAAAAADqr2IGAAAElUlEQVR42u3ay44qOwwF0P7/n+ZKZ3op2LaDhItVoxbQSWplkPjx9xc/j39P9fev/+v/v7n6r8knV7P8feLBhAkTJkxfyfR4+SRTvl5KvqyrXybj92ZJ3h0TJkyYMN2DKR+u+u3rMfPjPBnz9eblW4gJEyZMmH6TKT+kq6NVrxGP4Dm1nZgwYcKE6deYqovLP8lD4l6SFxMmTJgw/TJT9VjND+beOJ8IZZMk9YFcOCZMmDBh+jKmXgnwHn9/sL8JEyZMmDB9AdOj+CSNMnmaNb8QVN8lWU/hrTFhwoQJ01qmZOmn0q85dJRyHWxPjxsTJkyYMG1kyo/2/FidBNW9TyYEUcoYEyZMmDAtZ+qlPhPiHH3yGvnIzQ3DhAkTJkzLmfJwMTl68zaaSQF1MkIe9mPChAkTpnswnXrJXvkzmbd3nCdXmWidmDBhwoRpOVMeNPYuEMmMyZZMRktKtlHoiwkTJkyYVjFVy4d5A2uyxF5pMw/LT11uMGHChAnTPZiqR3L1aM+D0mqSdxKKF7YNEyZMmDAtZJqUG5Nf9lpaP9F+2ks0Y8KECROm7Uxvgr1iejRpOa1WCXuvlDeqlgu6mDBhwoRpFdMkLMwRz4a1yWp7Zdo3oS8mTJgwYboF0+QqMDmG82tEtXh5YFWYMGHChGktU+8SUE2h9hKsk5C1moCOvsWECRMmTMuZXh/wSQI3aV3Nx/kEUx7qv+nkxYQJEyZMS5jyds9TkWBvlnwNedK5MDsmTJgwYVrLlBTzelPOLxN5mF0NYqttspgwYcKEaS9Tr9WmerQnYfCklSfPxCZzjTLQmDBhwoRpIdPZUmX1lfIE8TxovxwNEyZMmDDdiCk/4PPQdDJXvpKkBNtExIQJEyZMa5l6IWuyrLwZKDnmJ6XK/ELT3EhMmDBhwrScqZo8raZrq+MkgXohgTsIoTFhwoQJ0xam6tFeLRb2SqFzpkk4fZnqxYQJEyZMq5iqIV+SwM0/n7TyJNC9cuaT9WDChAkTpuVMveJlNdl6NuE7X2HeloQJEyZMmO7BdKrsdwqxmqXOscr5b0yYMGHCtJYpn2CSCM5LpHlgXE3vVsP1J99iwoQJE6aFTPnL56needtNIShtXW7y7XySC8eECRMmTKuYqg00+eHdK3/mi+4F1b2QGxMmTJgwbWfqNegkR3WeMq6Gwb1k7qTdBxMmTJgw7WXKJ6hy9MY/lT7uXU0uZ8GECRMmTAuZ8haZ5AjvNZ6eTfL2tvYNIiZMmDBhugVTXpjMcfOgNy9A9g71fIMvq76YMGHChGkhUw40aY7poeTFyHKsX9wGTJgwYcK0l+lRfHpk1RGqRdP8k/wS8OTehAkTJkyYFjJVu1aSb3sNNNXi6NnGoMk1AhMmTJgwfT9TcgnIJ66mWXtp5UmjT69cigkTJkyYtjOdOnqrKeD8OpKH4r3nzZiYMGHChOkHmKrBarWQ2WOdlEgL/4sJEyZMmH6eaQLRayHNLx95uhkTJkyYMN2VKU/y5kzVAz5PBOcha55WjkJfTJgwYcK0kKmaAO21llZZqwd2zlfdBkyYMGHCtJbpP/br0aP7u9FcAAAAAElFTkSuQmCC">分享</a><div class="tags"></div><div class="post-nav"><a class="pre" href="/2021/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86-%E7%AC%AC%E4%B8%80%E7%AB%A0/">计算机组成原理-第一章</a><a class="next" href="/2021/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-%E8%87%AA%E9%A1%B6%E5%90%91%E4%B8%8B-%E7%AC%AC%E4%BA%94%E7%AB%A0/">计算机网络(自顶向下)第五章</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form class="search-form" action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="https://yvenxx.github.io/yvenxx"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Android/">Android</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/C/">C</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Java/">Java</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/python/">python</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%89%8D%E7%AB%AF/">前端</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/">操作系统</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/">数据结构</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%AE%97%E6%B3%95/">算法</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/">计算机组成原理</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/">计算机网络</a><span class="category-list-count">6</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2021/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86/">数据库原理</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/Redis%E5%9F%BA%E7%A1%80/">Redis基础</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-%E7%AC%AC%E4%BA%94%E7%AB%A0/">操作系统 第五章</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-%E7%AC%AC%E5%9B%9B%E7%AB%A0/">操作系统 第四章</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-%E7%AC%AC%E4%B8%89%E7%AB%A0/">操作系统-第三章</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-%E7%AC%AC%E4%BA%8C%E7%AB%A0/">操作系统-第二章</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-%E7%AC%AC%E4%B8%80%E7%AB%A0/">操作系统-第一章</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86-%E7%AC%AC%E4%B8%83%E7%AB%A0/">计算机组成原理-第七章</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86-%E7%AC%AC%E5%85%AD%E7%AB%A0/">计算机组成原理-第六章</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86-%E7%AC%AC%E4%BA%94%E7%AB%A0/">计算机组成原理-第五章</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="http://blog.yvenxx.cn/" title="懒人瑜恩" target="_blank">懒人瑜恩</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2022 <a href="/." rel="nofollow">懒人瑜恩.</a> Powered by Hexo.</div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=1.0.0" async></script><script type="text/javascript" src="/js/copycode.js" successtext="复制成功!"></script><link rel="stylesheet" type="text/css" href="/css/copycode.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=1.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=1.0.0"></script></div></body></html>